<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أذكار المسلم</title>
    <style>
        :root {
            --bg-morning: linear-gradient(135deg, #2C5F2D 0%, #4A7C59 100%);
            --bg-evening: linear-gradient(135deg, #2C3E50 0%, #4A6E8A 100%);
            --bg-sleep: linear-gradient(135deg, #1C2833 0%, #34495E 100%);
            --bg-baqiyat: linear-gradient(135deg, #005C97 0%, #363795 100%);
            --card-bg: rgba(255, 255, 255, 0.1);
            --card-hover-bg: rgba(255, 255, 255, 0.15);
            --card-completed-bg: rgba(46, 204, 113, 0.2);
            --text-color: #FFFFFF;
            --btn-bg: rgba(255, 255, 255, 0.2);
            --btn-active-border: #FFFFFF;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.8;
            transition: background 0.5s ease;
            min-height: 100vh;
            color: var(--text-color);
            font-size: 16px;
        }
        
        .morning { background: var(--bg-morning); }
        .evening { background: var(--bg-evening); }
        .sleep { background: var(--bg-sleep); }
        .baqiyat { background: var(--bg-baqiyat); }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 15px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            background: var(--btn-bg);
            color: var(--text-color);
            border: 2px solid transparent;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn.active {
            border-color: var(--btn-active-border);
        }
        
        .reminder-section {
            background: rgba(0, 0, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .reminder-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .time-input {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            font-size: 14px;
            text-align: center;
        }
        
        .time-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .reminder-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            background: rgba(52, 152, 219, 0.8);
            color: white;
        }
        
        .reminder-btn:hover {
            background: rgba(52, 152, 219, 1);
        }
        
        .reminder-btn.active {
            background: rgba(46, 204, 113, 0.8);
        }
        
        .reminder-status {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.8;
        }
        
        .dhikr-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .dhikr-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .dhikr-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .dhikr-card:hover {
            transform: translateY(-5px);
            background: var(--card-hover-bg);
        }
        
        .dhikr-card.completed {
            background: var(--card-completed-bg);
            opacity: 0.7;
        }
        
        .dhikr-text {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 15px;
            pointer-events: none;
            flex-grow: 1;
            white-space: pre-wrap;
        }
        
        .dhikr-source {
            font-size: 0.9rem;
            opacity: 0.8;
            text-align: center;
            margin-bottom: 15px;
            font-style: italic;
            pointer-events: none;
        }
        
        .dhikr-counter-display {
            font-size: 1rem;
            font-weight: bold;
            padding: 8px 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            text-align: center;
            margin-top: 15px;
            pointer-events: none;
        }
        
        .reset-container {
            text-align: center;
            margin: 25px 0;
        }
        
        .reset-btn {
            background: rgba(255, 82, 82, 0.7);
            border: none;
            color: white;
            padding: 12px 28px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .reset-btn:hover {
            background: rgba(255, 82, 82, 1);
            transform: translateY(-2px);
        }
        
        .footer-prayer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            font-style: italic;
            font-size: 0.9rem;
        }
    </style>
</head>
<body class="morning">
    <div class="container">
        <div class="header">
            <h1 id="main-title">أذكار الصباح</h1>
            <div class="controls">
                <button class="btn active" onclick="showSection('morning', this)">أذكار الصباح</button>
                <button class="btn" onclick="showSection('evening', this)">أذكار المساء</button>
                <button class="btn" onclick="showSection('sleep', this)">أذكار النوم</button>
                <button class="btn" onclick="showSection('baqiyat', this)">الباقيات الصالحات</button>
            </div>
        </div>

        <div class="reminder-section">
            <h3>🔔 تذكير الأذكار</h3>
            <div class="reminder-controls">
                <input type="time" id="reminder-time" class="time-input" placeholder="اختر الوقت">
                <button id="set-reminder-btn" class="reminder-btn">تفعيل التذكير</button>
                <button id="stop-reminder-btn" class="reminder-btn" style="display: none;">إيقاف التذكير</button>
            </div>
            <div id="reminder-status" class="reminder-status">اختر وقتًا لتفعيل التذكير اليومي</div>
        </div>

        <div id="dhikr-container" class="dhikr-grid">
            <!-- Dhikr cards will be loaded here -->
        </div>

        <div class="reset-container">
            <button class="reset-btn" id="reset-all-btn">🔄 إعادة ضبط العدادات</button>
        </div>

        <div class="footer-prayer">
            <p>اللهم اجعل هذا العمل خالصًا لوجهك الكريم وأنفع به المسلمين في كل مكان</p>
        </div>
    </div>

    <script>
        // بيانات الأذكار الكاملة
        const dhikrData = {
            morning: [
                {
                    text: "أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ\nاللّهُ لاَ إِلَـهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ.",
                    source: "آية الكرسي | من قالها حين يصبح أجير من الجن حتى يمسى",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ هُوَ ٱللَّهُ أَحَدٌ، ٱللَّهُ ٱلصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۢ.",
                    source: "سورة الإخلاص | من قالها حين يصبح وحين يمسى كفته من كل شىء",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ، مِن شَرِّ مَا خَلَقَ، وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِى ٱلْعُقَدِ، وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ.",
                    source: "سورة الفلق",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلنَّاسِ، مَلِكِ ٱلنَّاسِ، إِلَٰهِ ٱلنَّاسِ، مِن شَرِّ ٱلْوَسْوَاسِ ٱلْخَنَّاسِ، ٱلَّذِى يُوَسْوِسُ فِى صُدُورِ ٱلنَّاسِ، مِنَ ٱلْجِنَّةِ وَٱلنَّاسِ.",
                    source: "سورة الناس",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَصْـبَحْنا وَأَصْـبَحَ المُـلْكُ لله وَالحَمدُ لله، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذا اليوم وَخَـيرَ ما بَعْـدَه، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هذا اليوم وَشَرِّ ما بَعْـدَه، رَبِّ أَعـوذُبِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ، خَلَقْتَنـي وَأَنا عَبْـدُك، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت، أَعـوذُبِكَ مِنْ شَـرِّ ما صَنَـعْت، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ.",
                    source: "سيد الاستغفار | من قالها موقنا بها حين يصبح، فمات من يومه دخل الجنة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً.",
                    source: "من قالها 3 مرات كان حقا على الله أن يرضيه يوم القيامة",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أَصْبَـحْتُ أُشْـهِدُك، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك، وَمَلَائِكَتَكَ، وَجَمـيعَ خَلْـقِك، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك، وَأَنَّ ُ مُحَمّـداً عَبْـدُكَ وَرَسـولُـك.",
                    source: "من قالها 4 مرات أعتقه الله من النار",
                    count: 4,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ ما أَصْبَـَحَ بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر.",
                    source: "من قالها فقد أدى شكر يومه",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم.",
                    source: "من قالها 7 مرات كفاه الله ما أهمه من أمر الدنيا والآخرة",
                    count: 7,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم.",
                    source: "من قالها 3 مرات لم يضره من الله شيء",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ بِكَ أَصْـبَحْنا وَبِكَ أَمْسَـينا، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ النُّـشُور.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَصْبَـحْـنا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ: عَدَدَ خَلْـقِه، وَرِضـا نَفْسِـه، وَزِنَـةَ عَـرْشِـه، وَمِـدادَ كَلِمـاتِـه.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ عافِـني في بَدَنـي، اللّهُـمَّ عافِـني في سَمْـعي، اللّهُـمَّ عافِـني في بَصَـري، لا إلهَ إلاّ أَنْـتَ. اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر، وَالفَـقْر، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر، لا إلهَ إلاّ أَنْـتَ.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي، وَمِن فَوْقـي، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَصْبَـحْـنا وَأَصْبَـحْ المُـلكُ للهِ رَبِّ العـالَمـين، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ خَـيْرَ هذا اليوم، فَـتْحَهُ، وَنَصْـرَه، وَنـورَهُ وَبَـرَكَتَـهُ، وَهُـداهُ، وَأَعـوذُ بِـكَ مِـنْ شَـرِّ ما فـيهِ وَشَـرِّ ما بَعْـدَه.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه، أَشْهـدُ أَنْ لا إِلـهَ إِلاّ أَنْت، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ وَبَارِكْ على نَبِيِّنَا مُحمَّد.",
                    source: "من صلى عليّ 10 مرات أدركته شفاعتي يوم القيامة",
                    count: 10,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ الْهَمِّ وَالْحَزَنِ، وَأَعُوذُ بِكَ مِنْ الْعَجْزِ وَالْكَسَلِ، وَأَعُوذُ بِكَ مِنْ الْجُبْنِ وَالْبُخْلِ، وَأَعُوذُ بِكَ مِنْ غَلَبَةِ الدَّيْنِ، وَقَهْرِ الرِّجَالِ.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبَّلًا.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أستغفر الله وأتوب إليه.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "سبحان الله وبحمده.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                }
            ],
            evening: [
                {
                    text: "أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ\nاللّهُ لاَ إِلَـهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ.",
                    source: "آية الكرسي | من قالها حين يمسى أجير من الجن حتى يصبح",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ هُوَ ٱللَّهُ أَحَدٌ، ٱللَّهُ ٱلصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۢ.",
                    source: "سورة الإخلاص | من قالها حين يصبح وحين يمسى كفته من كل شىء",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ، مِن شَرِّ مَا خَلَقَ، وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِن شَرِّ ٱلنَّفَّٰثَٰتِ فِى ٱلْعُقَدِ، وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ.",
                    source: "سورة الفلق",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسْمِ اللهِ الرَّحْمنِ الرَّحِيم\nقُلْ أَعُوذُ بِرَبِّ ٱلنَّاسِ، مَلِكِ ٱلنَّاسِ، إِلَٰهِ ٱلنَّاسِ، مِن شَرِّ ٱلْوَسْوَاسِ ٱلْخَنَّاسِ، ٱلَّذِى يُوَسْوِسُ فِى صُدُورِ ٱلنَّاسِ، مِنَ ٱلْجِنَّةِ وَٱلنَّاسِ.",
                    source: "سورة الناس",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَمْسَيْـنا وَأَمْسـى المُـلْكُ لله وَالحَمدُ لله، لا إلهَ إلاّ اللّهُ وَحدَهُ لا شَريكَ لهُ، لهُ المُـلكُ ولهُ الحَمْـد، وهُوَ على كلّ شَيءٍ قدير، رَبِّ أسْـأَلُـكَ خَـيرَ ما في هـذه الليلة وَخَـيرَ ما بَعْـدَها، وَأَعـوذُ بِكَ مِنْ شَـرِّ ما في هذه الليلة وَشَرِّ ما بَعْـدَها، رَبِّ أَعـوذُبِكَ مِنَ الْكَسَـلِ وَسـوءِ الْكِـبَر، رَبِّ أَعـوذُ بِكَ مِنْ عَـذابٍ في النّـارِ وَعَـذابٍ في القَـبْر.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهـمَّ أَنْتَ رَبِّـي لا إلهَ إلاّ أَنْتَ، خَلَقْتَنـي وَأَنا عَبْـدُك، وَأَنا عَلـى عَهْـدِكَ وَوَعْـدِكَ ما اسْتَـطَعْـت، أَعـوذُبِكَ مِنْ شَـرِّ ما صَنَـعْت، أَبـوءُ لَـكَ بِنِعْـمَتِـكَ عَلَـيَّ وَأَبـوءُ بِذَنْـبي فَاغْفـِرْ لي فَإِنَّـهُ لا يَغْـفِرُ الذُّنـوبَ إِلاّ أَنْتَ.",
                    source: "سيد الاستغفار | من قالها موقنا بها حين يمسى، فمات من ليلته دخل الجنة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "رَضيـتُ بِاللهِ رَبَّـاً وَبِالإسْلامِ ديـناً وَبِمُحَـمَّدٍ صلى الله عليه وسلم نَبِيّـاً.",
                    source: "من قالها 3 مرات كان حقا على الله أن يرضيه يوم القيامة",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أَمسيْتُ أُشْـهِدُك، وَأُشْـهِدُ حَمَلَـةَ عَـرْشِـك، وَمَلَائِكَتَكَ، وَجَمـيعَ خَلْـقِك، أَنَّـكَ أَنْـتَ اللهُ لا إلهَ إلاّ أَنْـتَ وَحْـدَكَ لا شَريكَ لَـك، وَأَنَّ ُ مُحَمّـداً عَبْـدُكَ وَرَسـولُـك.",
                    source: "من قالها 4 مرات أعتقه الله من النار",
                    count: 4,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ ما أَمْسَى بي مِـنْ نِعْـمَةٍ أَو بِأَحَـدٍ مِـنْ خَلْـقِك، فَمِـنْكَ وَحْـدَكَ لا شريكَ لَـك، فَلَـكَ الْحَمْـدُ وَلَـكَ الشُّكْـر.",
                    source: "من قالها فقد أدى شكر ليلته",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "حَسْبِـيَ اللّهُ لا إلهَ إلاّ هُوَ عَلَـيهِ تَوَكَّـلتُ وَهُوَ رَبُّ العَرْشِ العَظـيم.",
                    source: "من قالها 7 مرات كفاه الله ما أهمه من أمر الدنيا والآخرة",
                    count: 7,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِسـمِ اللهِ الذي لا يَضُـرُّ مَعَ اسمِـهِ شَيءٌ في الأرْضِ وَلا في السّمـاءِ وَهـوَ السّمـيعُ العَلـيم.",
                    source: "من قالها 3 مرات لم يضره من الله شيء",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ بِكَ أَمْسَيْـنا، وَبِكَ أَصْبَحْـنا، وَبِكَ نَحْـيا وَبِكَ نَمُـوتُ وَإِلَـيْكَ المَصِير.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَمْسَيْـنا عَلَى فِطْرَةِ الإسْلاَمِ، وَعَلَى كَلِمَةِ الإِخْلاَصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إبْرَاهِيمَ حَنِيفاً مُسْلِماً وَمَا كَانَ مِنَ المُشْرِكِينَ.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "سُبْحـانَ اللهِ وَبِحَمْـدِهِ: عَدَدَ خَلْـقِه، وَرِضـا نَفْسِـه، وَزِنَـةَ عَـرْشِـه، وَمِـدادَ كَلِمـاتِـه.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ عافِـني في بَدَنـي، اللّهُـمَّ عافِـني في سَمْـعي، اللّهُـمَّ عافِـني في بَصَـري، لا إلهَ إلاّ أَنْـتَ. اللّهُـمَّ إِنّـي أَعـوذُ بِكَ مِنَ الْكُـفر، وَالفَـقْر، وَأَعـوذُ بِكَ مِنْ عَذابِ القَـبْر، لا إلهَ إلاّ أَنْـتَ.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في الدُّنْـيا وَالآخِـرَة، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ العَـفْوَ وَالعـافِـيةَ في ديني وَدُنْـيايَ وَأهْـلي وَمالـي، اللّهُـمَّ اسْتُـرْ عـوْراتي وَآمِـنْ رَوْعاتـي، اللّهُـمَّ احْفَظْـني مِن بَـينِ يَدَيَّ وَمِن خَلْفـي وَعَن يَمـيني وَعَن شِمـالي، وَمِن فَوْقـي، وَأَعـوذُ بِعَظَمَـتِكَ أَن أُغْـتالَ مِن تَحْتـي.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "يَا حَيُّ يَا قيُّومُ بِرَحْمَتِكَ أسْتَغِيثُ أصْلِحْ لِي شَأنِي كُلَّهُ وَلاَ تَكِلْنِي إلَى نَفْسِي طَـرْفَةَ عَيْنٍ.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَمْسَيْـنا وَأَمْسَى المُـلكُ للهِ رَبِّ العـالَمـين، اللّهُـمَّ إِنِّـي أسْـأَلُـكَ خَـيْرَ هذه الليلة، فَـتْحَهُا، وَنَصْـرَها، وَنـورَهُا وَبَـرَكَتَـهُا، وَهُـداهُا، وَأَعـوذُ بِـكَ مِـنْ شَـرِّ ما فـيهِا وَشَـرِّ ما بَعْـدَها.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ عالِـمَ الغَـيْبِ وَالشّـهادَةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كـلِّ شَـيءٍ وَمَليـكَه، أَشْهـدُ أَنْ لا إِلـهَ إِلاّ أَنْت، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي وَمِن شَـرِّ الشَّيْـطانِ وَشِرْكِهِ، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَعـوذُ بِكَلِمـاتِ اللّهِ التّـامّـاتِ مِنْ شَـرِّ ما خَلَـق.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ صَلِّ وَسَلِّمْ وَبَارِكْ على نَبِيِّنَا مُحمَّد.",
                    source: "10 مرات",
                    count: 10,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ الْهَمِّ وَالْحَزَنِ، وَأَعُوذُ بِكَ مِنْ الْعَجْزِ وَالْكَسَلِ، وَأَعُوذُ بِكَ مِنْ الْجُبْنِ وَالْبُخْلِ، وَأَعُوذُ بِكَ مِنْ غَلَبَةِ الدَّيْنِ، وَقَهْرِ الرِّجَالِ.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُمَّ إِنِّي أَسْأَلُكَ عِلْمًا نَافِعًا، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبَّلًا.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أستغفر الله وأتوب إليه.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "لا إله إلا الله وحده لا شريك له له الملك وله الحمد وهو على كل شيء قدير.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "سبحان الله وبحمده.",
                    source: "100 مرة",
                    count: 100,
                    currentCount: 0,
                    completed: false
                }
            ],
            sleep: [
                {
                    text: "بِاسْمِكَ رَبِّـي وَضَعْـتُ جَنْـبي، وَبِكَ أَرْفَعُـه، فَإِن أَمْسَـكْتَ نَفْسـي فارْحَـمْها، وَإِنْ أَرْسَلْتَـها فاحْفَظْـها بِمـا تَحْفَـظُ بِه عِبـادَكَ الصّـالِحـين.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ إِنَّـكَ خَلَـقْتَ نَفْسـي وَأَنْـتَ تَوَفّـاهـا لَكَ ممَـاتـها وَمَحْـياها، إِنْ أَحْيَيْـتَها فاحْفَظْـها، وَإِنْ أَمَتَّـها فَاغْفِـرْ لَـها. اللّهُـمَّ إِنَّـي أَسْـأَلُـكَ العـافِـيَة.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ قِنـي عَذابَـكَ يَـوْمَ تَبْـعَثُ عِبـادَك.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "بِاسْـمِكَ اللّهُـمَّ أَمـوتُ وَأَحْـيا.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "الـحَمْدُ للهِ الَّذي أَطْـعَمَنا وَسَقـانا، وَكَفـانا، وَآوانا، فَكَـمْ مِمَّـنْ لا كـافِيَ لَـهُ وَلا مُـؤْوي.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ عالِـمَ الغَـيبِ وَالشّـهادةِ فاطِـرَ السّماواتِ وَالأرْضِ رَبَّ كُـلِّ شَـيءٍ وَمَليـكَه، أَشْهـدُ أَنْ لا إِلـهَ إِلاّ أَنْت، أَعـوذُ بِكَ مِن شَـرِّ نَفْسـي، وَمِن شَـرِّ الشَّيْـطانِ وَشِـرْكِه، وَأَنْ أَقْتَـرِفَ عَلـى نَفْسـي سوءاً أَوْ أَجُـرَّهُ إِلـى مُسْـلِم.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللّهُـمَّ أَسْـلَمْتُ نَفْـسي إِلَـيْكَ، وَفَوَّضْـتُ أَمْـري إِلَـيْكَ، وَوَجَّـهْتُ وَجْـهي إِلَـيْكَ، وَأَلْـجَـاْتُ ظَهـري إِلَـيْكَ، رَغْبَـةً وَرَهْـبَةً إِلَـيْكَ، لا مَلْجَـأَ وَلا مَنْـجـا مِنْـكَ إِلاّ إِلَـيْكَ، آمَنْـتُ بِكِتـابِكَ الّـذي أَنْزَلْـتَ وَبِنَبِـيِّـكَ الّـذي أَرْسَلْـت.",
                    source: "مرة واحدة",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "سُبْحَانَ اللَّهِ.",
                    source: "33 مرة",
                    count: 33,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "الْحَمْدُ لِلَّهِ.",
                    source: "33 مرة",
                    count: 33,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "اللَّهُ أَكْبَرُ.",
                    source: "34 مرة",
                    count: 34,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "يجمع كفيه ثم ينفث فيهما والقراءة فيهما:\nقُلْ هُوَ اللَّهُ أَحَدٌ، قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ، قُلْ أَعُوذُ بِرَبِّ النَّاسِ.\nويمسح بهما ما استطاع من جسده.",
                    source: "3 مرات",
                    count: 3,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "آمَنَ الرَّسُولُ بِمَا أُنْزِلَ إِلَيْهِ مِنْ رَبِّهِ وَالْمُؤْمِنُونَ ۚ كُلٌّ آمَنَ بِاللَّهِ وَمَلَائِكَتِهِ وَكُتُبِهِ وَرُسُلِهِ لَا نُفَرِّقُ بَيْنَ أَحَدٍ مِنْ رُسُلِهِ ۚ وَقَالُوا سَمِعْنَا وَأَطَعْنَا ۖ غُفْرَانَكَ رَبَّنَا وَإِلَيْكَ الْمَصِيرُ. لَا يُكَلِّفُ اللَّهُ نَفْسًا إِلَّا وُسْعَهَا لَهَا مَا كَسَبَتْ وَعَلَيْهَا مَا اكْتَسَبَتْ رَبَّنَا لَا تُؤَاخِذْنَا إِنْ نَسِينَا أَوْ أَخْطَأْنَا رَبَّنَا وَلَا تَحْمِلْ عَلَيْنَا إِصْرًا كَمَا حَمَلْتَهُ عَلَى الَّذِينَ مِنْ قَبْلِنَا رَبَّنَا وَلَا تُحَمِّلْنَا مَا لَا طَاقَةَ لَنَا بِهِ وَاعْفُ عَنَّا وَاغْفِرْ لَنَا وَارْحَمْنَا أَنْتَ مَوْلَانَا فَانْصُرْنَا عَلَى الْقَوْمِ الْكَافِرِينَ.",
                    source: "سورة البقرة (285-286) | من قرأهما في ليلة كفتاه",
                    count: 1,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ\nاللّهُ لاَ إِلَـهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ.",
                    source: "آية الكرسى | أجير من الجن حتى يصبح",
                    count: 1,
                    currentCount: 0,
                    completed: false
                }
            ],
            baqiyat: [
                {
                    text: "سبحان الله",
                    source: "الباقيات الصالحات",
                    count: null,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "الحمد لله",
                    source: "الباقيات الصالحات",
                    count: null,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "لا إله إلا الله",
                    source: "الباقيات الصالحات",
                    count: null,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "الله أكبر",
                    source: "الباقيات الصالحات",
                    count: null,
                    currentCount: 0,
                    completed: false
                },
                {
                    text: "لا حول ولا قوة إلا بالله",
                    source: "كنز من كنوز الجنة",
                    count: null,
                    currentCount: 0,
                    completed: false
                }
            ]
        };

        // المتغيرات العامة
        let currentMode = 'morning';
        let reminderInterval = null;

        // وظائف حفظ واسترجاع البيانات
        function saveProgress() {
            const progress = {};
            Object.keys(dhikrData).forEach(mode => {
                progress[mode] = dhikrData[mode].map(d => ({
                    currentCount: d.currentCount,
                    completed: d.completed
                }));
            });
            localStorage.setItem('dhikrProgress_v6', JSON.stringify(progress));
        }

        function loadProgress() {
            try {
                const savedProgress = localStorage.getItem('dhikrProgress_v6');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    Object.keys(progress).forEach(mode => {
                        if (dhikrData[mode]) {
                            progress[mode].forEach((item, index) => {
                                if (dhikrData[mode][index]) {
                                    dhikrData[mode][index].currentCount = item.currentCount || 0;
                                    dhikrData[mode][index].completed = item.completed || false;
                                }
                            });
                        }
                    });
                }
            } catch (e) {
                console.error("Failed to load progress:", e);
            }
        }

        // نظام التذكير
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function showNotification(title, body) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, {
                    body: body,
                    icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiM0QTkwRTIiLz4KPHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDJDOC4yNjggMiAyIDguMjY4IDIgMTZTOC4yNjggMzAgMTYgMzAgMzAgMjMuNzMyIDMwIDE2UzIzLjczMiAyIDE2IDJaTTE2IDI2QzEwLjQ4NiAyNiA2IDIxLjUxNCA2IDE2UzEwLjQ4NiA2IDE2IDYgMjYgMTAuNDg2IDI2IDE2UzIxLjUxNCAyNiAxNiAyNloiIGZpbGw9IndoaXRlIi8+CjwvZz4KPC9zdmc+',
                    badge: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiM0QTkwRTIiLz4KPHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDJDOC4yNjggMiAyIDguMjY4IDIgMTZTOC4yNjggMzAgMTYgMzAgMzAgMjMuNzMyIDMwIDE2UzIzLjczMiAyIDE2IDJaTTE2IDI2QzEwLjQ4NiAyNiA2IDIxLjUxNCA2IDE2UzEwLjQ4NiA2IDE2IDYgMjYgMTAuNDg2IDI2IDE2UzIxLjUxNCAyNiAxNiAyNloiIGZpbGw9IndoaXRlIi8+CjwvZz4KPC9zdmc+'
                });
            }
        }

        function setReminder(time) {
            if (reminderInterval) {
                clearInterval(reminderInterval);
            }

            const [hours, minutes] = time.split(':').map(Number);
            
            function checkTime() {
                const now = new Date();
                const currentHours = now.getHours();
                const currentMinutes = now.getMinutes();
                
                if (currentHours === hours && currentMinutes === minutes) {
                    showNotification('🕌 تذكير الأذكار', 'حان وقت قراءة الأذكار. بارك الله فيك!');
                }
            }

            // فحص كل دقيقة
            reminderInterval = setInterval(checkTime, 60000);
            
            // حفظ الوقت
            localStorage.setItem('dhikrReminderTime', time);
            
            updateReminderStatus(time);
        }

        function stopReminder() {
            if (reminderInterval) {
                clearInterval(reminderInterval);
                reminderInterval = null;
            }
            localStorage.removeItem('dhikrReminderTime');
            updateReminderStatus(null);
        }

        function updateReminderStatus(time) {
            const statusElement = document.getElementById('reminder-status');
            const setBtn = document.getElementById('set-reminder-btn');
            const stopBtn = document.getElementById('stop-reminder-btn');
            
            if (time) {
                statusElement.textContent = `✅ التذكير مفعل يوميًا في ${time}`;
                setBtn.style.display = 'none';
                stopBtn.style.display = 'inline-block';
            } else {
                statusElement.textContent = 'اختر وقتًا لتفعيل التذكير اليومي';
                setBtn.style.display = 'inline-block';
                stopBtn.style.display = 'none';
            }
        }

        // إنشاء بطاقة الذكر
        function createDhikrCard(dhikr, index) {
            const card = document.createElement('div');
            card.className = `dhikr-card ${dhikr.completed ? 'completed' : ''}`;
            card.dataset.index = index;
            
            const counterText = dhikr.count === null ? 
                dhikr.currentCount.toString() : 
                `${dhikr.currentCount}/${dhikr.count}`;
            
            card.innerHTML = `
                <p class="dhikr-text">${dhikr.text}</p>
                <p class="dhikr-source">${dhikr.source}</p>
                <div class="dhikr-counter-display">${counterText}</div>
            `;
            
            card.addEventListener('click', () => handleCardClick(index));
            return card;
        }

        // عرض الأذكار
        function displayDhikr() {
            const container = document.getElementById('dhikr-container');
            container.innerHTML = '';
            dhikrData[currentMode].forEach((dhikr, index) => {
                container.appendChild(createDhikrCard(dhikr, index));
            });
        }

        // التعامل مع النقر على البطاقة
        function handleCardClick(index) {
            const dhikr = dhikrData[currentMode][index];
            
            // إذا كان الذكر مكتملاً، لا نفعل شيئاً
            if (dhikr.completed) return;

            // زيادة العداد
            dhikr.currentCount++;
            
            // فحص الاكتمال (فقط للأذكار التي لها عدد محدد)
            if (dhikr.count !== null && dhikr.currentCount >= dhikr.count) {
                dhikr.completed = true;
            }
            
            // حفظ التقدم وتحديث العرض
            saveProgress();
            updateCard(index);
        }

        // تحديث بطاقة واحدة
        function updateCard(index) {
            const card = document.querySelector(`.dhikr-card[data-index='${index}']`);
            if (card) {
                const dhikr = dhikrData[currentMode][index];
                const counterText = dhikr.count === null ? 
                    dhikr.currentCount.toString() : 
                    `${dhikr.currentCount}/${dhikr.count}`;
                
                card.querySelector('.dhikr-counter-display').textContent = counterText;
                
                if (dhikr.completed) {
                    card.classList.add('completed');
                } else {
                    card.classList.remove('completed');
                }
            }
        }

        // عرض قسم معين
        window.showSection = function(mode, clickedButton) {
            currentMode = mode;
            document.body.className = mode;
            
            const titles = {
                morning: 'أذكار الصباح',
                evening: 'أذكار المساء',
                sleep: 'أذكار النوم',
                baqiyat: 'الباقيات الصالحات'
            };
            document.getElementById('main-title').textContent = titles[mode];

            // تحديث الأزرار
            const buttons = document.querySelectorAll('.controls .btn');
            buttons.forEach(button => button.classList.remove('active'));
            clickedButton.classList.add('active');
            
            // عرض الأذكار
            displayDhikr();
        };

        // التحميل الأولي
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            displayDhikr();
            requestNotificationPermission();
            
            // استرجاع التذكير المحفوظ
            const savedTime = localStorage.getItem('dhikrReminderTime');
            if (savedTime) {
                document.getElementById('reminder-time').value = savedTime;
                setReminder(savedTime);
            }

            // أحداث التذكير
            document.getElementById('set-reminder-btn').addEventListener('click', () => {
                const time = document.getElementById('reminder-time').value;
                if (time) {
                    requestNotificationPermission();
                    setReminder(time);
                } else {
                    alert('يرجى اختيار وقت للتذكير');
                }
            });

            document.getElementById('stop-reminder-btn').addEventListener('click', () => {
                stopReminder();
                document.getElementById('reminder-time').value = '';
            });

            // زر إعادة الضبط
            document.getElementById('reset-all-btn').addEventListener('click', () => {
                dhikrData[currentMode].forEach(dhikr => {
                    dhikr.currentCount = 0;
                    dhikr.completed = false;
                });
                saveProgress();
                displayDhikr();
            });
        });
    </script>
</body>
</html>
